* Startup Stuff
** User info
#+BEGIN_SRC emacs-lisp
  (setq user-full-name "Ayush Singh")
  (setq user-mail-address "ayush1325@protonmail.com")
#+END_SRC
** Menus stuff
- Disable toolbar
- Shortent prompt answers
- Use ibuffer
#+BEGIN_SRC emacs-lisp
  (tool-bar-mode -1)
  (fset 'yes-or-no-p 'y-or-n-p)
  (defalias 'list-buffers 'ibuffer)
#+END_SRC
** Refresh Buffer
#+BEGIN_SRC emacs-lisp
  (global-set-key (kbd "<f5>") 'revert-buffer)
#+END_SRC
** Window Stuff
#+BEGIN_SRC emacs-lisp
  (windmove-default-keybindings)
  (winner-mode 1)

  (global-set-key (kbd "S-C-<left>") 'shrink-window-horizontally)
  (global-set-key (kbd "S-C-<right>") 'enlarge-window-horizontally)
  (global-set-key (kbd "S-C-<down>") 'shrink-window)
  (global-set-key (kbd "S-C-<up>") 'enlarge-window)

  (use-package ace-window
    :ensure t
    :bind
    ([remap other-window] . ace-window)
    :custom-face
    (aw-leading-char-face ((t (:inherit ace-jump-face-foreground :height 3.0)))))
#+END_SRC
** Line stuff
- Highlight current line
#+BEGIN_SRC emacs-lisp
  (global-hl-line-mode 1)
#+END_SRC
** Expand Select
#+BEGIN_SRC emacs-lisp
  (use-package expand-region
    :ensure t
    :bind (("C-=" . er/expand-region)))
#+END_SRC
** Multiple cursors
#+BEGIN_SRC emacs-lisp
  (use-package multiple-cursors
    :ensure t
    :bind (("C->" . mc/mark-next-like-this)
           ("C-<" . mc/mark-previous-like-this)))
#+END_SRC
** IEdit
Allows to edit same word at all instances
#+BEGIN_SRC emacs-lisp
  (use-package iedit
    :ensure t)
#+END_SRC
** Smart narrowing
#+BEGIN_SRC emacs-lisp
  (defun narrow-or-widen-dwim (p)
    (interactive "P")
    (declare (interactive-only))
    (cond ((and (buffer-narrowed-p) (not p)) (widen))
   ((region-active-p)
    (narrow-to-region (region-beginning) (region-end)))
   ((derived-mode-p 'org-mode)
     (cond ((ignore-errors (org-edit-src-code))
    (delete-other-windows))
   ((org-at-block-p)
    (org-narrow-to-block))
   (t (org-narrow-to-subtree))))
   (t (narrow-to-defun))))
   (define-key ctl-x-map "n" #'narrow-or-widen-dwim)
#+END_SRC
** Kill behaviour
For better integration with system clipboard
#+BEGIN_SRC emacs-lisp
  (setq save-interprogram-paste-before-kill t)
#+END_SRC
** Modline
#+BEGIN_SRC emacs-lisp
  (use-package doom-modeline
    :ensure t
    :init (doom-modeline-mode 1))
#+END_SRC
** Dashboard
#+BEGIN_SRC emacs-lisp
  (use-package dashboard
    :ensure t
    :if (< (length command-line-args) 2)
    :config
    (dashboard-setup-startup-hook)
    (setq initial-buffer-choice (lambda ()
                                  (get-buffer "*dashboard*")))
    (setq dashboard-banner-logo-title "Welcome to Emacs Dashboard")
    (setq dashboard-startup-banner 'logo)
    (setq dashboard-center-content t)
    (setq dashboard-items '((recents  . 5)
                            (projects . 10)))
    (setq dashboard-set-heading-icons t)
    (setq dashboard-set-file-icons t)
    (setq dashboard-set-init-info t))
#+END_SRC
** Page breaker
#+BEGIN_SRC emacs-lisp
  (use-package page-break-lines
    :ensure t
    :config
    (setq global-page-break-lines-mode 1))
#+END_SRC
** Quelpa
#+BEGIN_SRC emacs-lisp
  (use-package quelpa-use-package
    :ensure t
    :config
    (setq quelpa-upgrade-interval 7)
    (add-hook #'after-init-hook #'quelpa-upgrade-all-maybe))
#+END_SRC
** Auto Update packages
#+BEGIN_SRC emacs-lisp
  (use-package auto-package-update
    :ensure t
    :config
    (setq auto-package-update-delete-old-versions t)
    (setq auto-package-update-hide-results t)
    (auto-package-update-maybe))
#+END_SRC
** Transparency
#+BEGIN_SRC emacs-lisp
  (set-frame-parameter (selected-frame) 'alpha '(95 90))
  (add-to-list 'default-frame-alist '(alpha 95 90))
#+END_SRC
** Improve Joplin
#+BEGIN_SRC emacs-lisp
  (custom-set-variables
      '(server-switch-hook
        '((lambda nil
           (let (server-buf)
             (setq backup-by-copying t))))))
#+END_SRC
* Useful packages
** Try
To try out packages without installing
#+BEGIN_SRC emacs-lisp
  (use-package try
    :ensure t)
#+END_SRC
** Which Key
For key suggestions
#+BEGIN_SRC emacs-lisp
  (use-package which-key
    :ensure t
    :config (which-key-mode))
#+END_SRC
** Lorem ipsum
Random text generator
#+BEGIN_SRC emacs-lisp
  (use-package lorem-ipsum
    :ensure t)
#+END_SRC
** Consel
For ivy and better kill support
#+BEGIN_SRC emacs-lisp
  (use-package counsel
    :ensure t
    :bind
    (("M-y" . counsel-yank-pop)
     ("C-h f" . counsel-describe-function)
     ("C-h v" . counsel-describe-variable)
     :map ivy-minibuffer-map
     ("M-y" . ivy-next-line)))

  (use-package counsel-projectile
    :ensure t
    :bind (("C-c p" . projectile-command-map)))
#+END_SRC
** Ivy
Lot of autocompletions
#+BEGIN_SRC emacs-lisp
  (use-package ivy
    :ensure t
    :bind (("C-s" . swiper)
           ("M-x" . counsel-M-x)
           ("C-x C-f" . counsel-find-file))
    :config
    (setq ivy-use-virtual-buffers t)
    (setq enable-recursive-minibuffers t)
    (ivy-mode 1))
#+END_SRC
- Icons
#+BEGIN_SRC emacs-lisp
  (use-package all-the-icons-ivy-rich
    :ensure t
    :init (all-the-icons-ivy-rich-mode 1))

  (use-package ivy-rich
    :ensure t
    :init (ivy-rich-mode 1))

  (setq all-the-icons-ivy-rich-icon-size 0.8)
#+END_SRC
** Company 
For autocomplete inside buffer
#+BEGIN_SRC emacs-lisp
  (use-package company
    :ensure t
    :config
    (global-company-mode 1))

  (setq company-global-modes '(not org-mode markdown-mode))

  (use-package company-emoji
    :ensure t
    :config
    (add-to-list 'company-backends 'company-emoji))
#+END_SRC
** Undo Tree
For better undo and redo
#+BEGIN_SRC emacs-lisp
  (use-package undo-tree
    :ensure t
    :config
    (global-undo-tree-mode 1))
#+END_SRC
** Edit Indirect
#+BEGIN_SRC emacs-lisp
  (use-package edit-indirect
    :ensure t)
#+END_SRC
** Emoji Support
#+BEGIN_SRC emacs-lisp
  (use-package emojify
    :ensure t)
#+END_SRC
** IBuffer Projectile
Group ibuffer files based on projects
#+BEGIN_SRC emacs-lisp
  (use-package ibuffer-projectile
    :ensure t
    :config
    (add-hook 'ibuffer-hook
      (lambda ()
        (ibuffer-projectile-set-filter-groups)
        (unless (eq ibuffer-sorting-mode 'alphabetic)
          (ibuffer-do-sort-by-alphabetic)))))
#+END_SRC
** Hungry Delete
#+BEGIN_SRC emacs-lisp
  (use-package hungry-delete
    :ensure t
    :config (global-hungry-delete-mode t))
#+END_SRC
** Move Text
#+BEGIN_SRC emacs-lisp
  (use-package move-text
    :ensure t
    :bind (("M-<up>" . move-text-up)
           ("M-<down>" . move-text-down)))
#+END_SRC
** Treemacs
- Basic Install
#+BEGIN_SRC emacs-lisp
  (use-package treemacs
    :ensure t
    :defer t
    :init
    (with-eval-after-load 'winum
      (define-key winum-keymap (kbd "M-0") #'treemacs-select-window))
    :config
    (progn
      (setq treemacs-collapse-dirs                 (if treemacs-python-executable 3 0)
            treemacs-deferred-git-apply-delay      0.5
            treemacs-directory-name-transformer    #'identity
            treemacs-display-in-side-window        t
            treemacs-eldoc-display                 t
            treemacs-file-event-delay              5000
            treemacs-file-extension-regex          treemacs-last-period-regex-value
            treemacs-file-follow-delay             0.2
            treemacs-file-name-transformer         #'identity
            treemacs-follow-after-init             t
            treemacs-git-command-pipe              ""
            treemacs-goto-tag-strategy             'refetch-index
            treemacs-indentation                   2
            treemacs-indentation-string            " "
            treemacs-is-never-other-window         nil
            treemacs-max-git-entries               5000
            treemacs-missing-project-action        'ask
            treemacs-no-png-images                 nil
            treemacs-no-delete-other-windows       t
            treemacs-project-follow-cleanup        nil
            treemacs-persist-file                  (expand-file-name ".cache/treemacs-persist" user-emacs-directory)
            treemacs-position                      'left
            treemacs-recenter-distance             0.1
            treemacs-recenter-after-file-follow    nil
            treemacs-recenter-after-tag-follow     nil
            treemacs-recenter-after-project-jump   'always
            treemacs-recenter-after-project-expand 'on-distance
            treemacs-show-cursor                   nil
            treemacs-show-hidden-files             t
            treemacs-silent-filewatch              nil
            treemacs-silent-refresh                nil
            treemacs-sorting                       'alphabetic-asc
            treemacs-space-between-root-nodes      t
            treemacs-tag-follow-cleanup            t
            treemacs-tag-follow-delay              1.5
            treemacs-user-mode-line-format         nil
            treemacs-width                         35)
      (treemacs-follow-mode t)
      (treemacs-filewatch-mode t)
      (treemacs-fringe-indicator-mode t)
      (pcase (cons (not (null (executable-find "git")))
                   (not (null treemacs-python-executable)))
        (`(t . t)
         (treemacs-git-mode 'deferred))
        (`(t . _)
         (treemacs-git-mode 'simple))))
    :bind
    (:map global-map
          ("M-0"       . treemacs-select-window)
          ("C-x t 1"   . treemacs-delete-other-windows)
          ("C-x t t"   . treemacs)
          ("C-x t B"   . treemacs-bookmark)
          ("C-x t C-t" . treemacs-find-file)
          ("C-x t M-t" . treemacs-find-tag)))
#+END_SRC
- Projectile
#+BEGIN_SRC emacs-lisp
  (use-package treemacs-projectile
    :after treemacs projectile
    :ensure t)
#+END_SRC
- Icons
#+BEGIN_SRC emacs-lisp
  (use-package treemacs-icons-dired
    :after treemacs dired
    :ensure t
    :config (treemacs-icons-dired-mode))
#+END_SRC
- Magit Integration
#+BEGIN_SRC emacs-lisp
  (use-package treemacs-magit
    :after treemacs magit
    :ensure t)
#+END_SRC
* Programming
** Projectile
#+BEGIN_SRC emacs-lisp
  (use-package projectile
    :ensure t
    :config
    (projectile-mode +1)
    (setq projectile-completion-system 'ivy))
#+END_SRC
** Magit
#+BEGIN_SRC emacs-lisp
  (use-package magit
    :ensure t
    :config
    (setq git-commit-summary-max-length 50))
#+END_SRC
** LSP
#+BEGIN_SRC emacs-lisp
  (use-package lsp-mode
    :ensure t
    :init (setq lsp-keymap-prefix "s-l")
    :hook ((prog-mode . lsp)
           (vue-mode . lsp)
           (lsp-mode . lsp-enable-which-key-integration))
    :commands lsp)

  (use-package lsp-ui
    :ensure t
    :commands lsp-ui-mode)

  (use-package company-lsp
    :ensure t
    :commands company-lsp)

  (use-package lsp-ivy
    :ensure t
    :commands lsp-ivy-workspace-symbol)

  (use-package dap-mode
    :ensure t)
#+END_SRC
- Company Settings
#+BEGIN_SRC emacs-lisp
  (setq company-minimum-prefix-length 1
        company-idle-delay 0.0)
#+END_SRC
- Increase GC threashold
#+BEGIN_SRC emacs-lisp
  (setq gc-cons-threshold 100000000)
#+END_SRC
- Increase data read by a process
#+BEGIN_SRC emacs-lisp
  (setq read-process-output-max (* 1024 1024))
#+END_SRC
- Increase refresh rate.
#+BEGIN_SRC emacs-lisp
  (setq lsp-idle-delay 0.500)
#+END_SRC
- Perspective Integration
#+BEGIN_SRC emacs-lisp
  (use-package treemacs-persp
    :after treemacs persp-mode
    :ensure t
    :config (treemacs-set-scope-type 'Perspectives))
#+END_SRC
- Treemacs Integration
#+BEGIN_SRC emacs-lisp
  (use-package lsp-treemacs
    :config
    (lsp-metals-treeview-enable t)
    (setq lsp-metals-treeview-show-when-views-received t)
    (lsp-treemacs-sync-mode 1))
#+END_SRC
** Rust Mode
#+BEGIN_SRC emacs-lisp
  (use-package rust-mode
    :ensure t)
#+END_SRC
** Lisp
*** Common
#+BEGIN_SRC emacs-lisp
  (use-package rainbow-delimiters
    :ensure t
    :hook ((lisp-mode clojure-mode) . rainbow-delimiters-mode))

  (use-package smartparens
    :ensure t
    :hook ((clojure-mode cider-repl-mode) . smartparens-strict-mode))

  (use-package aggressive-indent
    :ensure t
    :hook (clojure-mode . aggressive-indent-mode))
#+END_SRC
*** Common Lisp
#+BEGIN_SRC emacs-lisp
  (use-package slime
    :ensure t
    :config
    (setq inferior-lisp-program "sbcl")
    (setq slime-contribs '(slime-fancy)))
#+END_SRC
*** Emacs Lisp
#+BEGIN_SRC emacs-lisp
  (use-package paredit
    :ensure t
    :hook ((emacs-lisp-mode slime-repl-mode lisp-mode) . paredit-mode))

  (use-package eldoc
    :ensure t
    :hook (emacs-lisp-mode . eldoc-mode))

  (use-package highlight-defined
    :ensure t
    :hook (emacs-lisp-mode . highlight-defined-mode))
#+END_SRC
*** Clojure
#+BEGIN_SRC emacs-lisp
  (use-package clojure-mode
    :ensure t)

  (use-package cider
    :ensure t
    :hook (clojure-mode . cider-mode))
#+END_SRC
** Markdown
#+BEGIN_SRC emacs-lisp
  (use-package markdown-mode
    :ensure t
    :commands (markdown-mode gfm-mode)
    :mode (("README\\.md\\'" . gfm-mode)
           ("\\.md\\'" . markdown-mode)
           ("\\.markdown\\'" . markdown-mode))
    :init (setq markdown-command "multimarkdown"))

  (use-package adaptive-wrap
    :ensure t
    :hook (markdown-mode . adaptive-wrap-prefix-mode))
#+END_SRC
** Web Dev
- Web Mode
#+BEGIN_SRC emacs-lisp
  (use-package web-mode
    :ensure t
    :config
    (setq web-mode-enable-auto-pairing t)
    (setq web-mode-enable-css-colorization t)
    (add-to-list 'auto-mode-alist '("\\.vue\\'" . web-mode))
    (setq web-mode-markup-indent-offset 2)
    (setq web-mode-css-indent-offset 2)
    (setq web-mode-code-indent-offset 2))
#+END_SRC
- Emmet
#+BEGIN_SRC emacs-lisp
  (use-package emmet-mode
    :ensure t
    :hook web-mode)
#+END_SRC
- Prettier
#+BEGIN_SRC emacs-lisp
  (use-package prettier-js
    :ensure t
    :hook (web-mode . prettier-js-mode))
#+END_SRC
- Javascript
#+BEGIN_SRC emacs-lisp
  (use-package js2-mode
    :ensure t
    :config
    (add-to-list 'auto-mode-alist '("\\.js\\'" . js2-mode)))
#+END_SRC
- Skewer Mode
#+BEGIN_SRC emacs-lisp
  (use-package skewer-mode
    :hook ((js2-mode . skewer-mode)
           (css-mode . skewer-css-mode)
           (html-mode . skewer-html-mode))
    :ensure t)
#+END_SRC
** Rest Client
- Basic package
#+BEGIN_SRC emacs-lisp
  (use-package restclient
    :ensure t)
#+END_SRC
- Org support
#+BEGIN_SRC emacs-lisp
  (use-package ob-restclient
    :ensure t)
#+END_SRC
- Company integration
#+BEGIN_SRC emacs-lisp
  (use-package company-restclient
    :ensure t
    :config
    (add-to-list 'company-backends 'company-restclient))
#+END_SRC
** Python
- Pipenv porcelain
#+BEGIN_SRC emacs-lisp
  (use-package pipenv
    :ensure t
    :config
    (setq pipenv-with-flycheck nil))
#+END_SRC
** Dart
- Basic Mode
#+BEGIN_SRC emacs-lisp
  (use-package dart-mode
    :ensure t
    :custom
    (dart-format-on-save t)
    (dart-sdk-path "~/flutter/bin/cache/dart-sdk/"))
#+END_SRC
- Language Server
#+BEGIN_SRC emacs-lisp
  (use-package lsp-dart 
    :ensure t 
    :hook (dart-mode . lsp))
#+END_SRC
** Golang
#+BEGIN_SRC emacs-lisp
  (use-package go-mode
    :ensure t)
#+END_SRC
** Flutter
#+BEGIN_SRC emacs-lisp
  (use-package flutter
    :ensure t
    :bind (:map dart-mode-map
                ("C-M-x" . #'flutter-run-or-hot-reload))
    :custom
    (flutter-sdk-path "~/flutter/"))
#+END_SRC
** General
- Some Keybindings
#+BEGIN_SRC emacs-lisp
  (add-hook 'prog-mode
            (lambda ()
              (define-key "\C-a" 'back-to-indentation)))
#+END_SRC
* Org Mode
** Pretty Bullets
#+BEGIN_SRC emacs-lisp
  (use-package org-bullets
    :ensure t
    :hook (org-mode . org-bullets-mode))
#+END_SRC
** Custom variables
#+BEGIN_SRC emacs-lisp
  (setq org-startup-indented t)
  (setq org-startup-folded (quote overview))
#+END_SRC
** Pretty stuff
#+BEGIN_SRC emacs-lisp
  (setq org-src-fontify-natively t)
  (setq org-ellipsis "â¤µ")
  (setq org-src-tab-acts-natively t)
#+END_SRC
** Babel
#+BEGIN_SRC emacs-lisp
  (org-babel-do-load-languages
   'org-babel-load-languages
   '((restclient . t)
     (emacs-lisp . t)
     (clojure . t)))

  (setq org-babel-clojure-backend 'cider)
#+END_SRC
* Eshell
** Aweshell
#+BEGIN_SRC emacs-lisp
  (use-package aweshell
    :quelpa (aweshell :fetcher git :url "https://github.com/manateelazycat/aweshell.git")
    :defer 1
    :config
    (with-eval-after-load "esh-opt"
      (autoload 'epe-theme-lambda "eshell-prompt-extras")
      (setq eshell-highlight-prompt nil
            eshell-prompt-function 'epe-theme-lambda)))

  (use-package exec-path-from-shell
    :ensure t)

  (when (memq window-system '(mac ns x))
    (exec-path-from-shell-initialize))
#+END_SRC
** Autosuggestions
#+BEGIN_SRC emacs-lisp
  (use-package esh-autosuggest
    :ensure t
    :hook (eshell-mode . esh-autosuggest-mode))
#+END_SRC
** Extras
#+BEGIN_SRC emacs-lisp
  (use-package eshell-prompt-extras
    :ensure t)
#+END_SRC
** Smart display
#+BEGIN_SRC emacs-lisp
  (require 'eshell)
  (require 'em-smart)
  (setq eshell-where-to-jump 'begin)
  (setq eshell-review-quick-commands nil)
  (setq eshell-smart-space-goes-to-end t)
#+END_SRC
** Load Path
#+BEGIN_SRC emacs-lisp
  (setenv "PATH" (concat
                  "/usr/local/bin" path-separator
                  (getenv "PATH")))
#+END_SRC
* Dired
** Async
#+BEGIN_SRC emacs-lisp
  (use-package async
    :ensure t
    :config
    (dired-async-mode 1))
#+END_SRC
** Dired+
#+BEGIN_SRC emacs-lisp
  (use-package dired+
    :quelpa (dired+ :fetcher url :url "https://www.emacswiki.org/emacs/download/dired+.el")
    :defer 1)
#+END_SRC
* Asthetic Stuff
** Pretty stuff
#+BEGIN_SRC emacs-lisp
  (use-package highlight-parentheses
    :ensure t
    :hook (prog-mode . highlight-parentheses-mode))

  (global-prettify-symbols-mode +1)

  (use-package rainbow-mode
    :ensure t
    :hook prog-mode)

  (setq frame-title-format '((:eval (projectile-project-name))))
#+END_SRC
** Icons
#+BEGIN_SRC emacs-lisp
  (use-package all-the-icons
    :ensure t)
#+END_SRC
** Theme
#+BEGIN_SRC emacs-lisp
  (use-package doom-themes
    :ensure t
    :config
    (setq doom-themes-enable-bold t)
    (setq doom-themes-enable-italic t)
    (load-theme 'doom-dracula t))

  (doom-themes-visual-bell-config)

  (doom-themes-org-config)
#+END_SRC
* Other Modes
** Engine Mode
To search directly from eamcs
#+BEGIN_SRC emacs-lisp
  (use-package engine-mode
    :ensure t
    :config
    (engine-mode t))

  (defengine duckduckgo
    "https://duckduckgo.com/?q=%s"
    :keybinding "d")
#+END_SRC
** Pdf
- Basic mode
#+BEGIN_SRC emacs-lisp
  (use-package pdf-tools
    :ensure t
    :config
    (require 'pdf-tools)
    (require 'pdf-view)
    (require 'pdf-misc)
    (require 'pdf-occur)
    (require 'pdf-util)
    (require 'pdf-annot)
    (require 'pdf-info)
    (require 'pdf-isearch)
    (require 'pdf-history)
    (require 'pdf-links)
    (pdf-tools-install :no-query))
#+END_SRC
- Save last position
#+BEGIN_SRC emacs-lisp
  (use-package pdf-view-restore
    :ensure t
    :config
    (add-hook 'pdf-view-mode-hook 'pdf-view-restore-mode))
#+END_SRC
** Json
#+BEGIN_SRC emacs-lisp
  (use-package json-mode
    :ensure t)
#+END_SRC
** Yaml
#+BEGIN_SRC emacs-lisp
  (use-package yaml-mode
    :ensure t)
#+END_SRC
* Operating System stuff
** System packages
#+BEGIN_SRC emacs-lisp
  (use-package system-packages
    :ensure t)
#+END_SRC
- Add yay Support
#+BEGIN_SRC emacs-lisp
  (add-to-list 'system-packages-supported-package-managers
               '(yay .
                        ((default-sudo . nil)
                         (install . "yay -S")
                         (search . "yay -Ss")
                         (uninstall . "yay -Rs")
                         (update . "yay -Syu")
                         (clean-cache . "yay -Sc")
                         (log . "cat /var/log/pacman.log")
                         (change-log . "yay -Qc")
                         (get-info . "yay -Qi")
                         (get-info-remote . "yay -Si")
                         (list-files-provided-by . "yay -Ql")
                         (owning-file . "yay -Qo")
                         (owning-file-remote . "yay -F")
                         (verify-all-packages . "yay -Qkk")
                         (verify-all-dependencies . "yay -Dk")
                         (remove-orphaned . "yay -Rns $(pacman -Qtdq)")
                         (list-installed-packages . "yay -Qe")
                         (list-installed-packages-all . "yay -Q")
                         (list-dependencies-of . "yay -Qi")
                         (noconfirm . "--noconfirm"))))

  (setq system-packages-package-manager 'yay)
  (setq system-packages-use-sudo nil)
#+END_SRC
